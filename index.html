<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Organigramma â€” Benedetta Bruzziches</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #F8F7F4; font-family: 'Cormorant Garamond', Georgia, serif; color: #1A1A18; }
  button { font-family: inherit; }
</style>
</head>
<body>
<div id="root"></div>
<script type="module">
import React from "https://esm.sh/react@18.2.0";
import ReactDOM from "https://esm.sh/react-dom@18.2.0/client";
const { useState, createElement: h } = React;

const DEPTS = {
  stile:         { label: "Ufficio Stile",         color: "#8B6F4F", light: "#F7F0E8", dark: "#6B5030", reportTo: "Benedetta", side: "left" },
  comunicazione: { label: "Comunicazione",         color: "#4A6A8B", light: "#E8EFF7", dark: "#2A4A6B", reportTo: "Benedetta", side: "left" },
  digital:       { label: "Digital & E-commerce",  color: "#4A7A50", light: "#E8F4EA", dark: "#2A5A30", reportTo: "Benedetta + Agostino", side: "center" },
  admin:         { label: "Amministrazione & B2B", color: "#8B4A5E", light: "#F7E8EE", dark: "#6B2A3E", reportTo: "Agostino", side: "right" },
  produzione:    { label: "Produzione & Operations", color: "#5E4A8B", light: "#EFE8F7", dark: "#3E2A6B", reportTo: "Agostino", side: "right" },
};

const DEPT_LINKS = [
  { from: "stile",      to: "produzione",    label: "Campionario e schede tecniche" },
  { from: "stile",      to: "comunicazione", label: "Supporto operativo shooting" },
  { from: "digital",    to: "comunicazione", label: "ADV \u00B7 Newsletter \u00B7 Sito" },
  { from: "admin",      to: "produzione",    label: "Materiali + Ordini B2B" },
  { from: "produzione", to: "digital",       label: "Spedizioni B2C + Stock" },
  { from: "digital",    to: "admin",         label: "DDT \u00B7 Corrieri \u00B7 Press" },
];

const PEOPLE = {
  stile: {
    summary: "Cuore creativo del brand. Sviluppa l\u2019identit\u00E0 estetica di ogni collezione: modelli, materiali, colori, accessori metallici.",
    hierarchy: [
      { name: "Claudia", role: "Creative Lead", level: 0, desc: "Guida creativa quotidiana: ricerca, concept, sviluppo estetico modelli, materiali, colori, proporzioni. Supervisione diretta di Domitilla per la parte accessori metallici" },
      { name: "Elisa", role: "Operations & Production Coord.", level: 0, badge: "Doppio ruolo",
        desc: "Coordina fornitori, schede tecniche, gestisce campionari e timing, magazzino materiali e campioni, catalogazione materiali e aggiornamento database Notion. Supporto diretto a Benedetta su task operative nei momenti di minor carico. Segreteria operativa per Comunicazione" },
    ],
    externals: [
      { name: "Domitilla", what: "Design accessori metallici, progettazione chiusure, ricerca e coordinamento fornitori accessori. Riporta a Claudia + Benedetta" },
    ],
    crossLinks: [
      { person: "Elisa", to: "Giulio", toDept: "produzione", type: "Ponte operativo", why: "Coordina il passaggio di schede tecniche e prototipi dallo Stile alla Produzione per il campionario" },
      { person: "Elisa", to: "Roberta", toDept: "comunicazione", type: "Doppio riporto", why: "Segreteria operativa: organizza shooting, gestisce logistica dei fornitori creativi" },
      { person: "Domitilla", to: "Giulio", toDept: "produzione", type: "Ponte tecnico", why: "Coordinamento con la produzione per la realizzazione e verifica prototipi degli accessori metallici" },
    ],
  },
  comunicazione: {
    summary: "Custode della voce del brand. Governa tutto ci\u00F2 che il brand dice, mostra e comunica.",
    hierarchy: [
      { name: "Roberta", role: "Communication Manager \u2014 Regia Editoriale & PR Strategy", level: 0, desc: "Piano editoriale, regia contenuti su tutti i canali, PR strategy, governance editoriale sito, contenuti ADV e newsletter, coordinamento creativi esterni, shooting, collaborazioni influencer" },
      { name: "Marianna", role: "Social Media Operations", level: 1, reportsTo: "Roberta", desc: "Scheduling, publishing, community management, coordinamento content contributors, gestione asset library" },
    ],
    externals: [
      { name: "Ornella", what: "Fotografia professionale" },
      { name: "Ilaria", what: "Video e formati video" },
      { name: "Gaetano", what: "Fotografia di prodotto" },
      { name: "HOON", what: "Content dalla Bottega" },
      { name: "Uff. Stampa MI", what: "PR execution e rassegna stampa" },
    ],
    crossLinks: [],
    intersections: [
      { area: "ADV", comms: "Contenuti creativi: visual, copy, format", digital: "Budget, targeting, piattaforme, performance, refresh" },
      { area: "Newsletter", comms: "Contenuti: testi, tono, layout editoriale", digital: "Klaviyo: automazioni, segmenti, deliverability, tech" },
      { area: "Sito", comms: "Content owner: pagine, copy, immagini, brand", digital: "Tech owner: backlog, release, performance, hosting" },
    ],
    openItems: [
      "Audit influencer e collaborazioni da parte di Roberta",
      "Ridefinizione strategica piano editoriale Instagram brand",
      "Definire output e scadenze chiare: giorno del mese per consegna ADV, comunicato stampa, ecc.",
    ],
  },
  digital: {
    summary: "Governa la presenza digitale del brand: e-commerce, CRM, sito web, dati, ADV e automazioni.",
    hierarchy: [
      { name: "Fabio", role: "Digital Lead", level: 0, desc: "Responsabile unico infrastruttura digitale. Sito web (tech lead completo), connettore Notion/WooCommerce, migrazione CRM Mailchimp \u2192 Klaviyo, governance campagne ADV Meta e Google, blog SEO, admin tech Notion" },
      { name: "Caterina Nobili", role: "E-commerce Manager & Owner B2C", level: 0, badge: "Owner cliente B2C", desc: "Owner relazione cliente B2C end-to-end. Caricamento prodotti sul sito e gestione estetica e-commerce. Shopping experience Bottega. Press operations. Resi B2C. Magazzino sito. Community e clienteling" },
    ],
    crossLinks: [
      { person: "Fabio", to: "Roberta", toDept: "comunicazione", type: "Intersezione", why: "ADV (budget vs contenuti), Newsletter (Klaviyo vs copy), Sito (tech vs content). Escalation a Benedetta in caso di disaccordo" },
      { person: "Caterina", to: "Debora", toDept: "produzione", type: "Ponte operativo", why: "Preparazione e spedizione ordini B2C. Debora prepara pacchi, Valentina gestisce DDT e corriere" },
      { person: "Caterina", to: "Roberta", toDept: "comunicazione", type: "Coordinamento", why: "Coerenza brand sui contenuti press. Caterina gestisce operativit\u00E0 press, Roberta strategia PR" },
      { person: "Caterina", to: "Simona", toDept: "admin", type: "Flusso press", why: "Spedizioni campioni press: Caterina decide cosa mandare \u2192 Simona coordina \u2192 Debora spedisce" },
    ],
    openItems: ["\u26A0 PUNTO CRITICO: Caterina ha il carico pi\u00F9 alto dell\u2019organico. Serve una risorsa dedicata (stagista) per WhatsApp/SMS marketing e community management"],
  },
  admin: {
    summary: "Gestisce la parte finanziaria, contabile, gli acquisti e il canale wholesale B2B.",
    hierarchy: [
      { name: "Simona Gigliotti", role: "Resp. Amministrativo & Wholesale", level: 0, desc: "Supervisione amministrazione, contabilit\u00E0, servizi finanziari. Wholesale B2B, rapporti Bonini, pagamenti, solleciti, interfaccia commercialista" },
      { name: "Alice", role: "Ufficio Acquisti", level: 0, badge: "Backup admin", desc: "Gestione fornitori, approvvigionamento, analisi dati acquisti, negoziazione, budget, ricerca nuovi fornitori. Elabora RdA ricevute da Giulio" },
      { name: "Valentina", role: "Segreteria Amministrativa & Logistica", level: 1, reportsTo: "Simona", note: "Part-time 09\u201313", desc: "DDT, pratiche corriere e prenotazioni spedizioni B2C. Recupero crediti. Gestione magazzino e-commerce. Supporto amministrazione BB Comba (Coriolo)" },
    ],
    crossLinks: [
      { person: "Alice", to: "Giulio", toDept: "produzione", type: "Ponte operativo", why: "Giulio elabora fabbisogni e RdA, Alice le inserisce in Team System e gestisce fino a entrata magazzino" },
      { person: "Valentina", to: "Debora", toDept: "produzione", type: "Flusso DDT", why: "Debora prepara i pacchi, Valentina gestisce DDT e documenti di trasporto per spedizioni in uscita" },
    ],
  },
  produzione: {
    summary: "Il cuore produttivo e operativo: dalla programmazione al prodotto finito, inclusi qualit\u00E0, sarte, spedizioni.",
    hierarchy: [
      { name: "Giulio", role: "Resp. Produzione & Operations", level: 0, desc: "Programmazione produzione, supervisione reparti produttivi, gestione risorse e obiettivi, monitoraggio fornitori esterni, flussi materiali, elaborazione RdA. NCR e resi B2B" },
      { name: "Debora Antonini", role: "Resp. Controllo Qualit\u00E0 & Spedizioni Uscita", level: 0, desc: "Controllo finale prodotti, rilevamento difetti, packaging. Preparazione fisica pacchi e spedizioni in uscita (B2C + B2B). Magazzino prodotto finito" },
      { name: "Ada", role: "Gestione Sarte & Lavorazioni Manuali", level: 0, note: "Ruolo autonomo", desc: "Si coordina direttamente con le sarte esterne. Gestisce in autonomia la filiera di cucitura. Pianificazione kit per modello/variante con Giulio" },
      { name: "Federico Costantini", role: "Addetto alla Produzione", level: 1, reportsTo: "Giulio", desc: "Ricezione e smistamento materie prime, taglio materiali, lavorazione, assemblaggio, verifica meccanismi, completamento prodotto finito" },
      { name: "Laura Nocera", role: "Laboratorio & Ricezione Spedizioni", level: 1, reportsTo: "Giulio", desc: "Lavora in laboratorio (produzione). Analisi materie prime. Gestisce spedizioni in entrata. Supporto magazzino materie prime" },
      { name: "Laura Pontuale", role: "Supporto Gestione Sarte & QC", level: 1, reportsTo: "Debora + Ada", desc: "Controllo conformit\u00E0 in entrata, interfaccia kit sarte, riparazione difetti cucitura, pulizia e preparazione prodotti" },
    ],
    crossLinks: [
      { person: "Debora", to: "Simona", toDept: "admin", type: "Ponte operativo", why: "Coordinamento per la gestione ordini B2B, spedizioni clienti wholesale e magazzino prodotto finito" },
      { person: "Debora", to: "Caterina", toDept: "digital", type: "Ponte operativo", why: "Preparazione e spedizione ordini B2C. Debora prepara i pacchi, Valentina gestisce DDT e corriere" },
      { person: "Giulio", to: "Alice", toDept: "admin", type: "Flusso RdA", why: "Giulio elabora fabbisogni e RdA, Alice le inserisce in Team System e gestisce fino a entrata magazzino" },
    ],
    notes: [
      "Agostino interviene direttamente in laboratorio per risolvere problemi operativi",
      "Resi B2C e B2B: file condivisi separati. Laura Pontuale: minimo 1h/giorno dedicata a riparazioni resi",
      "Federico: nei periodi di minor carico supporta manutenzione magazzino, ordine laboratorio, produzione Bottega/Coriolo",
    ],
  },
};

const font = "'Cormorant Garamond', Georgia, serif";
const deptOrder = ["stile", "comunicazione", "digital", "admin", "produzione"];

function MacroChart({ selectedDept, onSelect }) {
  const W = 1000, dirY = 55, splitY = 105, deptY = 195;
  const boxW = 148, boxH = 76;
  const deptX = { stile: 130, comunicazione: 320, digital: 500, admin: 680, produzione: 870 };
  const benX = 225, agoX = 775;
  const benDepts = ["stile", "comunicazione"];
  const agoDepts = ["admin", "produzione"];
  const linkedDepts = new Set();
  if (selectedDept) {
    linkedDepts.add(selectedDept);
    DEPT_LINKS.forEach(l => { if (l.from === selectedDept) linkedDepts.add(l.to); if (l.to === selectedDept) linkedDepts.add(l.from); });
  }
  const c = [];
  c.push(h("rect", { key: "bg1", x: 30, y: 25, width: 440, height: 115, rx: 8, fill: "#F4F2EE", opacity: 0.5 }));
  c.push(h("text", { key: "t1", x: 44, y: 42, fill: "#B0A898", fontSize: 7, letterSpacing: "0.16em", fontWeight: 500, style: { fontFamily: font } }, "AREA BENEDETTA"));
  c.push(h("rect", { key: "bg2", x: 530, y: 25, width: 440, height: 115, rx: 8, fill: "#F4F2EE", opacity: 0.5 }));
  c.push(h("text", { key: "t2", x: 544, y: 42, fill: "#B0A898", fontSize: 7, letterSpacing: "0.16em", fontWeight: 500, style: { fontFamily: font } }, "AREA AGOSTINO"));
  c.push(h("rect", { key: "bg3", x: 430, y: 25, width: 140, height: 115, rx: 0, fill: "#EAF0EA", opacity: 0.25 }));
  c.push(h("rect", { key: "bb", x: benX-90, y: dirY-24, width: 180, height: 48, rx: 5, fill: "#1A1A18" }));
  c.push(h("text", { key: "bn", x: benX, y: dirY-4, textAnchor: "middle", fill: "#FAFAF6", fontSize: 15, fontWeight: 500, style: { fontFamily: font }, letterSpacing: "0.03em" }, "Benedetta"));
  c.push(h("text", { key: "br", x: benX, y: dirY+11, textAnchor: "middle", fill: "#A09888", fontSize: 8, style: { fontFamily: font }, letterSpacing: "0.08em" }, "Direzione Creativa \u00B7 Comunicazione"));
  c.push(h("rect", { key: "ab", x: agoX-90, y: dirY-24, width: 180, height: 48, rx: 5, fill: "#1A1A18" }));
  c.push(h("text", { key: "an", x: agoX, y: dirY-4, textAnchor: "middle", fill: "#FAFAF6", fontSize: 15, fontWeight: 500, style: { fontFamily: font }, letterSpacing: "0.03em" }, "Agostino"));
  c.push(h("text", { key: "ar", x: agoX, y: dirY+11, textAnchor: "middle", fill: "#A09888", fontSize: 8, style: { fontFamily: font }, letterSpacing: "0.08em" }, "CEO \u00B7 Finanza \u00B7 Produzione"));
  c.push(h("line", { key: "bl", x1: benX, y1: dirY+24, x2: benX, y2: splitY, stroke: "#A09888", strokeWidth: 1, opacity: 0.3 }));
  benDepts.forEach(id => c.push(h("path", { key: `b-${id}`, d: `M${benX},${splitY} L${deptX[id]},${splitY} L${deptX[id]},${deptY-boxH/2}`, fill: "none", stroke: DEPTS[id].color, strokeWidth: 1.2, opacity: 0.3 })));
  c.push(h("line", { key: "al", x1: agoX, y1: dirY+24, x2: agoX, y2: splitY, stroke: "#A09888", strokeWidth: 1, opacity: 0.3 }));
  agoDepts.forEach(id => c.push(h("path", { key: `a-${id}`, d: `M${agoX},${splitY} L${deptX[id]},${splitY} L${deptX[id]},${deptY-boxH/2}`, fill: "none", stroke: DEPTS[id].color, strokeWidth: 1.2, opacity: 0.3 })));
  c.push(h("path", { key: "d1", d: `M${benX},${splitY} L${deptX.digital},${splitY} L${deptX.digital},${deptY-boxH/2}`, fill: "none", stroke: DEPTS.digital.color, strokeWidth: 0.8, opacity: 0.2, strokeDasharray: "5,3" }));
  c.push(h("path", { key: "d2", d: `M${agoX},${splitY} L${deptX.digital},${splitY}`, fill: "none", stroke: DEPTS.digital.color, strokeWidth: 0.8, opacity: 0.2, strokeDasharray: "5,3" }));
  deptOrder.forEach(id => {
    const d = DEPTS[id], x = deptX[id], isSel = selectedDept === id, isLinked = linkedDepts.size > 0 ? linkedDepts.has(id) : true;
    const data = PEOPLE[id], count = data.hierarchy.length, ch = [];
    if (isSel) ch.push(h("rect", { key: "sh", x: x-boxW/2+2, y: deptY-boxH/2+2, width: boxW, height: boxH, rx: 7, fill: "rgba(0,0,0,0.04)" }));
    ch.push(h("rect", { key: "bx", x: x-boxW/2, y: deptY-boxH/2, width: boxW, height: boxH, rx: 7, fill: isSel ? d.light : "#FFF", stroke: isSel ? d.color : isLinked ? d.color+"50" : d.color+"18", strokeWidth: isSel ? 2.5 : 1, opacity: isLinked ? 1 : 0.5 }));
    ch.push(h("rect", { key: "tp", x: x-boxW/2, y: deptY-boxH/2, width: boxW, height: 5, fill: d.color, opacity: isLinked ? 1 : 0.3 }));
    ch.push(h("text", { key: "lb", x, y: deptY-10, textAnchor: "middle", fill: "#1A1A18", fontSize: 11.5, fontWeight: 600, style: { fontFamily: font }, opacity: isLinked ? 1 : 0.5 }, d.label));
    ch.push(h("text", { key: "ct", x, y: deptY+4, textAnchor: "middle", fill: d.color, fontSize: 8, style: { fontFamily: font }, opacity: isLinked ? 0.7 : 0.3 }, count+" persone"+(data.externals ? " + "+data.externals.length+" esterni" : "")));
    ch.push(h("text", { key: "rp", x, y: deptY+16, textAnchor: "middle", fill: "#A09888", fontSize: 7.5, style: { fontFamily: font }, opacity: isLinked ? 0.6 : 0.25 }, "\u2192 "+d.reportTo));
    ch.push(h("text", { key: "tg", x, y: deptY+boxH/2-6, textAnchor: "middle", fill: d.color, fontSize: 7.5, style: { fontFamily: font }, opacity: 0.4 }, isSel ? "\u25B2 chiudi dettaglio" : "\u25BC apri dettaglio"));
    c.push(h("g", { key: "g-"+id, onClick: () => onSelect(isSel ? null : id), style: { cursor: "pointer" } }, ...ch));
  });
  DEPT_LINKS.forEach((link, i) => {
    const x1 = deptX[link.from], x2 = deptX[link.to], baseY = deptY+boxH/2+4, arcDepth = 14+i*10, arcY = baseY+arcDepth, midX = (x1+x2)/2;
    const isHi = selectedDept ? (selectedDept === link.from || selectedDept === link.to) : false;
    c.push(h("g", { key: "arc-"+i },
      h("path", { d: `M${x1},${baseY} C${x1},${arcY} ${x2},${arcY} ${x2},${baseY}`, fill: "none", stroke: isHi ? "#1A1A18" : "#B8B0A0", strokeWidth: isHi ? 2 : 1, strokeDasharray: "7,4", opacity: isHi ? 0.5 : 0.18 }),
      h("text", { x: midX, y: arcY-4, textAnchor: "middle", fill: isHi ? "#1A1A18" : "#A09888", fontSize: isHi ? 8 : 7, fontWeight: isHi ? 600 : 400, style: { fontFamily: font }, opacity: isHi ? 0.85 : 0.4 }, link.label)
    ));
  });
  c.push(h("text", { key: "l1", x: 16, y: dirY+2, fill: "#D0C8B8", fontSize: 7, letterSpacing: "0.14em", style: { fontFamily: font } }, "DIREZIONE"));
  c.push(h("text", { key: "l2", x: 16, y: deptY+2, fill: "#D0C8B8", fontSize: 7, letterSpacing: "0.14em", style: { fontFamily: font } }, "REPARTI"));
  return h("svg", { viewBox: "0 0 "+W+" 340", style: { width: "100%", maxWidth: W, display: "block", margin: "0 auto" } }, ...c);
}

function DeptDetail({ deptId, onClose }) {
  const dept = DEPTS[deptId], data = PEOPLE[deptId], s = [];
  s.push(h("div", { key: "hd", style: { padding: "18px 24px", background: "linear-gradient(145deg, "+dept.light+"80, #FFF)", borderBottom: "1px solid "+dept.color+"0C", display: "flex", alignItems: "center", gap: 14 } },
    h("div", { style: { width: 44, height: 44, borderRadius: 10, background: dept.color, display: "flex", alignItems: "center", justifyContent: "center", color: "#FFF", fontSize: 18, fontWeight: 300, fontFamily: font } }, data.hierarchy.length),
    h("div", { style: { flex: 1 } },
      h("div", { style: { fontSize: 19, fontWeight: 600, fontFamily: font } }, dept.label),
      h("div", { style: { fontSize: 10, color: "#A09888", fontFamily: font, marginTop: 2 } }, "Riporta a ", h("strong", { style: { color: "#5A5848" } }, dept.reportTo)),
      h("div", { style: { fontSize: 11, color: "#6A6858", fontFamily: font, marginTop: 4, lineHeight: 1.5 } }, data.summary)
    ),
    h("button", { onClick: onClose, style: { background: "none", border: "1px solid "+dept.color+"25", padding: "5px 14px", fontSize: 10, color: dept.color, cursor: "pointer", fontFamily: font, borderRadius: 5, alignSelf: "flex-start" } }, "\u2715 Chiudi")
  ));
  s.push(h("div", { key: "pp", style: { padding: "16px 24px 8px" } },
    h("div", { style: { fontSize: 8.5, letterSpacing: "0.16em", textTransform: "uppercase", color: "#A09888", marginBottom: 12, fontWeight: 500, fontFamily: font } }, "Chi lavora qui"),
    ...data.hierarchy.map((p, i) =>
      h("div", { key: i, style: { display: "flex", alignItems: "flex-start", gap: 12, padding: "12px 0", borderBottom: i < data.hierarchy.length-1 ? "1px solid #F2EEEA" : "none", marginLeft: p.level*28 } },
        h("div", { style: { width: 26, height: 26, borderRadius: 13, flexShrink: 0, background: p.level===0 ? dept.color : dept.light, border: p.level===0 ? "none" : "1.5px solid "+dept.color+"30", color: p.level===0 ? "#FFF" : dept.color, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, fontWeight: 600, fontFamily: font } }, p.name.charAt(0)),
        h("div", { style: { flex: 1 } },
          h("div", { style: { display: "flex", alignItems: "center", gap: 6, flexWrap: "wrap" } },
            h("span", { style: { fontSize: 14, fontWeight: 600, fontFamily: font } }, p.name),
            p.badge ? h("span", { style: { fontSize: 7.5, textTransform: "uppercase", color: "#B07030", background: "#B0703010", padding: "2px 8px", fontWeight: 600, fontFamily: font, borderRadius: 3 } }, p.badge) : null,
            p.note ? h("span", { style: { fontSize: 7.5, color: "#5080A0", background: "#5080A008", padding: "2px 8px", fontFamily: font, borderRadius: 3 } }, p.note) : null
          ),
          h("div", { style: { fontSize: 10, color: dept.color, fontFamily: font, marginTop: 2 } }, p.role),
          p.reportsTo ? h("div", { style: { fontSize: 9, color: "#A09888", fontFamily: font, marginTop: 2 } }, "\u2192 Riporta a ", h("strong", null, p.reportsTo)) : null,
          h("div", { style: { fontSize: 11, color: "#4A4840", fontFamily: font, marginTop: 5, lineHeight: 1.65 } }, p.desc)
        )
      )
    )
  ));
  if (data.crossLinks && data.crossLinks.length > 0) {
    s.push(h("div", { key: "cl", style: { padding: "4px 24px 16px" } },
      h("div", { style: { fontSize: 8.5, letterSpacing: "0.16em", textTransform: "uppercase", color: "#A09888", marginBottom: 10, fontWeight: 500, fontFamily: font, paddingTop: 14, borderTop: "1px solid #F0ECE4" } }, "Connessioni con altri reparti"),
      ...data.crossLinks.map((lk, i) => {
        const td = DEPTS[lk.toDept];
        return h("div", { key: i, style: { padding: "12px 16px", marginBottom: 8, background: td.light+"60", border: "1px solid "+td.color+"10", borderLeft: "4px solid "+td.color+"50", borderRadius: 5 } },
          h("div", { style: { display: "flex", alignItems: "center", gap: 8, flexWrap: "wrap", marginBottom: 5 } },
            h("span", { style: { display: "inline-flex", alignItems: "center", gap: 4, padding: "2px 10px", background: "#FFF", border: "1px solid "+dept.color+"20", borderRadius: 12, fontSize: 11, fontWeight: 600, fontFamily: font } }, h("span", { style: { width: 6, height: 6, borderRadius: 3, background: dept.color, display: "inline-block" } }), " "+lk.person),
            h("span", { style: { fontSize: 14, color: "#C0B8A8" } }, "\u27F6"),
            h("span", { style: { display: "inline-flex", alignItems: "center", gap: 4, padding: "2px 10px", background: "#FFF", border: "1px solid "+td.color+"20", borderRadius: 12, fontSize: 11, fontWeight: 600, fontFamily: font } }, h("span", { style: { width: 6, height: 6, borderRadius: 3, background: td.color, display: "inline-block" } }), " "+lk.to),
            h("span", { style: { fontSize: 7.5, textTransform: "uppercase", color: td.color, fontWeight: 500, fontFamily: font } }, lk.type)
          ),
          h("div", { style: { fontSize: 11, color: "#4A4840", lineHeight: 1.6, fontFamily: font } }, lk.why)
        );
      })
    ));
  }
  if (data.intersections) {
    s.push(h("div", { key: "in", style: { padding: "4px 24px 16px" } },
      h("div", { style: { fontSize: 8.5, letterSpacing: "0.16em", textTransform: "uppercase", color: "#A09888", marginBottom: 10, fontWeight: 500, fontFamily: font, paddingTop: 14, borderTop: "1px solid #F0ECE4" } }, "Intersezioni con Digital"),
      h("div", { style: { border: "1px solid #E4E0D8", borderRadius: 6, overflow: "hidden" } },
        h("div", { style: { display: "grid", gridTemplateColumns: "100px 1fr 1fr", background: "#FAFAF6", borderBottom: "1px solid #E4E0D8" } },
          h("div", { style: { padding: "8px 12px", fontSize: 9, fontWeight: 600, fontFamily: font, color: "#888" } }, "Area"),
          h("div", { style: { padding: "8px 12px", fontSize: 9, fontWeight: 600, fontFamily: font, color: dept.color } }, "Comunicazione"),
          h("div", { style: { padding: "8px 12px", fontSize: 9, fontWeight: 600, fontFamily: font, color: DEPTS.digital.color } }, "Digital")
        ),
        ...data.intersections.map((row, i) =>
          h("div", { key: i, style: { display: "grid", gridTemplateColumns: "100px 1fr 1fr", borderBottom: i < data.intersections.length-1 ? "1px solid #F0ECE4" : "none" } },
            h("div", { style: { padding: "10px 12px", fontSize: 11, fontWeight: 600, fontFamily: font } }, row.area),
            h("div", { style: { padding: "10px 12px", fontSize: 10.5, fontFamily: font, color: "#4A4840", lineHeight: 1.5 } }, row.comms),
            h("div", { style: { padding: "10px 12px", fontSize: 10.5, fontFamily: font, color: "#4A4840", lineHeight: 1.5 } }, row.digital)
          )
        )
      ),
      h("div", { style: { fontSize: 10, color: "#8A8878", fontStyle: "italic", fontFamily: font, marginTop: 8 } }, "Regola: se Fabio e Roberta non trovano un accordo, la decisione sale a Benedetta.")
    ));
  }
  if (data.externals) {
    s.push(h("div", { key: "ex", style: { padding: "4px 24px 18px" } },
      h("div", { style: { fontSize: 8.5, letterSpacing: "0.16em", textTransform: "uppercase", color: "#A09888", marginBottom: 10, fontWeight: 500, fontFamily: font, paddingTop: 14, borderTop: "1px solid #F0ECE4" } }, "Collaboratori esterni ("+data.externals.length+")"),
      h("div", { style: { display: "grid", gridTemplateColumns: "repeat(auto-fill, minmax(200px, 1fr))", gap: 8 } },
        ...data.externals.map((ext, i) =>
          h("div", { key: i, style: { padding: "10px 14px", background: dept.light, border: "1px solid "+dept.color+"0C", borderRadius: 5 } },
            h("div", { style: { fontSize: 11.5, fontWeight: 600, fontFamily: font } }, ext.name),
            h("div", { style: { fontSize: 9.5, color: "#6A6858", fontFamily: font, marginTop: 2 } }, ext.what)
          )
        )
      )
    ));
  }
  if (data.openItems && data.openItems.length > 0) {
    s.push(h("div", { key: "oi", style: { padding: "4px 24px 16px" } },
      ...data.openItems.map((item, i) =>
        h("div", { key: i, style: { padding: "10px 14px", background: item.startsWith("\u26A0") ? "#FFF0F0" : "#FFF8E8", borderLeft: "3px solid "+(item.startsWith("\u26A0") ? "#D04040" : "#E0A030"), borderRadius: 3, fontSize: 11, color: item.startsWith("\u26A0") ? "#8A2020" : "#8A6A20", fontStyle: "italic", lineHeight: 1.65, fontFamily: font, marginBottom: 6 } }, item)
      )
    ));
  }
  if (data.notes) {
    s.push(h("div", { key: "nt", style: { padding: "4px 24px 16px" } },
      ...data.notes.map((n, i) =>
        h("div", { key: i, style: { padding: "10px 14px", background: dept.color+"05", borderLeft: "3px solid "+dept.color+"25", borderRadius: 3, fontSize: 11, color: "#5A5850", fontStyle: "italic", lineHeight: 1.65, fontFamily: font, marginBottom: 6 } }, n)
      )
    ));
  }
  return h("div", { style: { maxWidth: 740, margin: "2px auto 24px", background: "#FFF", border: "1px solid "+dept.color+"18", borderTop: "4px solid "+dept.color, borderRadius: "0 0 8px 8px", boxShadow: "0 4px 20px rgba(0,0,0,0.04)" } }, ...s);
}

function Organigramma() {
  const [sel, setSel] = useState(null);
  return h("div", { style: { fontFamily: font, background: "#F8F7F4", minHeight: "100vh", color: "#1A1A18" } },
    h("header", { style: { textAlign: "center", padding: "36px 20px 14px" } },
      h("div", { style: { fontSize: 10, letterSpacing: "0.45em", textTransform: "uppercase", color: "#A09888" } }, "Organigramma"),
      h("h1", { style: { fontSize: 30, fontWeight: 300, letterSpacing: "0.1em", margin: "4px 0" } }, "Benedetta Bruzziches"),
      h("div", { style: { fontSize: 10, letterSpacing: "0.22em", color: "#B0A898", textTransform: "uppercase" } }, "Febbraio 2026 \u00B7 Rev 6"),
      h("div", { style: { display: "flex", justifyContent: "center", gap: 14, marginTop: 12, flexWrap: "wrap" } },
        ...["16 persone interne", "6 collaboratori esterni", "6 aree operative"].map((t, i) =>
          h("span", { key: i, style: { fontSize: 10, color: "#7A7868", background: "#EFEDE8", padding: "4px 12px", borderRadius: 3 } }, t)
        )
      ),
      h("div", { style: { marginTop: 14, fontSize: 11, color: "#8A8878", lineHeight: 1.7, maxWidth: 600, margin: "14px auto 0" } },
        h("strong", null, "Linee continue"), " = gerarchia. ", h("strong", null, "Archi tratteggiati"), " = collaborazioni operative tra reparti. ", h("br"), "Clicca su un reparto per esplorare chi ci lavora e le connessioni."
      )
    ),
    h("div", { style: { padding: "0 12px" } }, h(MacroChart, { selectedDept: sel, onSelect: setSel })),
    sel ? h("div", { style: { padding: "0 16px" } }, h(DeptDetail, { deptId: sel, onClose: () => setSel(null) })) : null,
    h("div", { style: { maxWidth: 740, margin: "0 auto", padding: "10px 20px 6px", display: "flex", flexWrap: "wrap", gap: 14, justifyContent: "center", fontSize: 9.5, color: "#8A8878" } },
      ...Object.entries(DEPTS).map(([id, d]) =>
        h("span", { key: id, style: { display: "inline-flex", alignItems: "center", gap: 5 } },
          h("span", { style: { width: 9, height: 9, borderRadius: 2, background: d.color, display: "inline-block" } }), d.label
        )
      )
    ),
    h("div", { style: { textAlign: "center", padding: "6px 0 32px", fontSize: 8.5, letterSpacing: "0.18em", color: "#C8C0B0", textTransform: "uppercase" } }, "\u00A9 Benedetta Bruzziches \u00B7 Documento interno \u00B7 Rev 6 \u00B7 26 febbraio 2026")
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(h(Organigramma));
</script>
</body>
</html>
